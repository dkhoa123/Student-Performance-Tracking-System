@model SPTS_Service.ViewModel.Giangvien
@{
    Layout = "~/Views/Shared/_LayoutGiangVien.cshtml";
}
        <!-- Main Content Area -->
        <main class="flex flex-1 flex-col h-full overflow-hidden bg-background-light dark:bg-background-dark relative">
            <!-- Scrollable Content -->
            <div class="flex-1 overflow-y-auto p-4 md:p-8">
                <div class="mx-auto max-w-7xl space-y-8 pb-10">
                    <!-- Welcome Heading -->
                    <div class="flex flex-col gap-1">
                        <h1 class="text-3xl font-black tracking-tight text-slate-900 dark:text-white md:text-4xl">Xin chào, Thầy @Model.TeacherName 👋</h1>
                        <p class="text-base text-slate-500 dark:text-slate-400">Đây là tổng quan tình hình học tập của các lớp hôm nay.</p>
                    </div>
                    <!-- Stats Row -->
                    <div class="grid grid-cols-1 gap-4 sm:grid-cols-3">
                        <!-- Stat Card 1 -->
                        <div class="group relative flex flex-col justify-between overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-sm border border-slate-100 dark:border-slate-800 transition-all hover:shadow-md hover:border-primary/30">
                            <div class="absolute right-0 top-0 p-4 opacity-10 transition-opacity group-hover:opacity-20">
                                <span class="material-symbols-outlined text-8xl text-primary">groups</span>
                            </div>
                            <div class="relative z-10 flex items-center gap-3">
                                <div class="flex size-10 items-center justify-center rounded-full bg-blue-50 dark:bg-blue-900/30 text-primary">
                                    <span class="material-symbols-outlined">school</span>
                                </div>
                                <p class="text-sm font-medium text-slate-500 dark:text-slate-400">Tổng số học sinh</p>
                            </div>
                            <div class="relative z-10 mt-4">
                                <p class="text-3xl font-bold text-slate-900 dark:text-white">@Model.TotalStudents</p>
                                <div class="mt-1 flex items-center gap-1 text-xs font-medium text-green-600 dark:text-green-400">
                                    <span class="material-symbols-outlined text-sm">trending_up</span>
                                </div>
                            </div>
                        </div>
                        <!-- Stat Card 2 -->
                        <div class="group relative flex flex-col justify-between overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-sm border border-slate-100 dark:border-slate-800 transition-all hover:shadow-md hover:border-emerald-500/30">
                            <div class="absolute right-0 top-0 p-4 opacity-10 transition-opacity group-hover:opacity-20">
                                <span class="material-symbols-outlined text-8xl text-emerald-500">bar_chart</span>
                            </div>
                            <div class="relative z-10 flex items-center gap-3">
                                <div class="flex size-10 items-center justify-center rounded-full bg-emerald-50 dark:bg-emerald-900/30 text-emerald-600">
                                    <span class="material-symbols-outlined">functions</span>
                                </div>
                                <p class="text-sm font-medium text-slate-500 dark:text-slate-400">Điểm trung bình</p>
                            </div>
                            <div class="relative z-10 mt-4">
                                <p class="text-3xl font-bold text-slate-900 dark:text-white">@Model.AverageScore.ToString("0.0")</p>
                                <div class="mt-1 flex items-center gap-1 text-xs font-medium text-green-600 dark:text-green-400">
                                    <span class="material-symbols-outlined text-sm">trending_up</span>
                                </div>
                            </div>
                        </div>
                        <!-- Stat Card 3 -->
                        <div class="group relative flex flex-col justify-between overflow-hidden rounded-2xl bg-white dark:bg-slate-900 p-6 shadow-sm border border-slate-100 dark:border-slate-800 transition-all hover:shadow-md hover:border-orange-500/30">
                            <div class="absolute right-0 top-0 p-4 opacity-10 transition-opacity group-hover:opacity-20">
                                <span class="material-symbols-outlined text-8xl text-orange-500">warning</span>
                            </div>
                            <div class="relative z-10 flex items-center gap-3">
                                <div class="flex size-10 items-center justify-center rounded-full bg-orange-50 dark:bg-orange-900/30 text-orange-600">
                                    <span class="material-symbols-outlined">priority_high</span>
                                </div>
                                <p class="text-sm font-medium text-slate-500 dark:text-slate-400">Cần chú ý</p>
                            </div>
                            <div class="relative z-10 mt-4">
                                <p class="text-3xl font-bold text-slate-900 dark:text-white">@Model.AtRiskStudents</p>
                                <div class="mt-1 flex items-center gap-1 text-xs font-medium text-orange-600 dark:text-orange-400">
                                    <span>Học sinh cần hỗ trợ ngay</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Main Grid Content -->
                    <div class="grid grid-cols-1 gap-8 lg:grid-cols-3">
                        <!-- Left Column: Charts & Classes -->
                        <div class="flex flex-col gap-8 lg:col-span-2">
                            <!-- Chart Section -->
                            <div class="rounded-2xl border border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900 p-6 shadow-sm">
                                <div class="mb-6 flex items-center justify-between">
                                    <div>
                                        <h3 class="text-lg font-bold text-slate-900 dark:text-white">Xu hướng điểm số</h3>
                                        <p class="text-sm text-slate-500 dark:text-slate-400">Theo dõi sự tiến bộ qua từng học kỳ</p>
                                    </div>
                                    <select class="rounded-lg border-slate-200 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 py-1.5 px-3 text-sm font-medium text-slate-600 dark:text-slate-300 focus:border-primary focus:ring-primary">
                                        <option>Học kỳ 1</option>
                                        <option>Học kỳ 2</option>
                                    </select>
                                </div>
                                <div class="relative h-64 w-full">
                                <canvas id="gpaChart" height="120"></canvas>

                                </div>
                                <div class="mt-2 flex justify-between px-2 text-xs font-semibold text-slate-400">
                                    <span>Tháng 9</span>
                                    <span>Tháng 10</span>
                                    <span>Tháng 11</span>
                                    <span>Tháng 12</span>
                                </div>
                            </div>
                                     <script>
                                            const chartLabels = @Html.Raw(
                                            Json.Serialize(Model.ChartData.Select(x => x.TermName))
                                                );

                                            const chartValues = @Html.Raw(
                                            Json.Serialize(Model.ChartData.Select(x => x.AverageGpa))
                                                );
                                     </script>
                            <!-- My Classes Grid -->
                            <div>
                                <div class="mb-4 flex items-center justify-between">
                                    <h3 class="text-xl font-bold text-slate-900 dark:text-white">Lớp học của tôi</h3>
                                    <a class="text-sm font-semibold text-primary hover:text-blue-600" href="#">Xem tất cả</a>
                                </div>
                        <div class="grid gap-4 sm:grid-cols-2">
                            @foreach (var term in Model.SectionsByTerm)
                            {
                                foreach (var cls in term.Sections)
                                     {
                                <div class="group flex flex-col rounded-2xl border bg-white p-5 shadow-sm cursor-pointer">
                                    <div class="mb-4 flex items-start justify-between">
                                        <div class="flex items-center gap-3">
                                            <div class="flex size-12 items-center justify-center rounded-xl bg-slate-100 text-primary">
                                                <span class="material-symbols-outlined">school</span>
                                            </div>
                                            <div>
                                                <h4 class="font-bold">@cls.CourseCode</h4>
                                                <p class="text-xs text-slate-500">
                                                    @cls.CourseName • @cls.Room
                                                </p>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mt-auto">
                                        <div class="mb-2 flex justify-between text-sm">
                                            <span>@cls.StudentCount Học sinh</span>
                                            <span class="font-semibold">
                                                @cls.CompletionRate.ToString("0")% Hoàn thành
                                            </span>
                                        </div>

                                        <div class="h-2 w-full rounded-full bg-slate-100">
                                            <div class="h-full rounded-full bg-primary"
                                                 style="width:@cls.CompletionRate%">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                }   
                            }
                        </div>

                            </div>
                        </div>
                        <!-- Right Column: Alerts & Needs Attention -->
                        <div class="flex flex-col gap-6">
                            <!-- Alert Section -->
                            <div class="flex flex-col rounded-2xl border border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900 shadow-sm overflow-hidden">
                                <div class="flex items-center justify-between border-b border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-800/30 px-6 py-4">
                                    <div class="flex items-center gap-2">
                                        <span class="flex size-2 rounded-full bg-red-500 animate-pulse"></span>
                                        <h3 class="font-bold text-slate-900 dark:text-white">Cảnh báo hiệu suất</h3>
                                    </div>
                                    <span class="rounded-full bg-red-100 dark:bg-red-900/30 px-2.5 py-0.5 text-xs font-bold text-red-600 dark:text-red-400">5 Mới</span>
                                </div>
                                <div class="flex flex-col divide-y divide-slate-100 dark:divide-slate-800">
                            @foreach (var alert in Model.RecentAlerts)
                            {
                                <div class="flex items-start gap-4 p-4">
                                    <div class="flex size-10 items-center justify-center rounded-full"
                                         style="background:@alert.IconColor">
                                        <span class="material-symbols-outlined text-white">
                                            @alert.IconName
                                        </span>
                                    </div>

                                    <div class="flex-1">
                                        <p class="font-bold">@alert.StudentName</p>
                                        <p class="text-xs">@alert.Message</p>
                                    </div>
                                </div>
                            }

                                </div>
                                <div class="bg-slate-50 dark:bg-slate-800/30 p-3 text-center">
                                    <button class="text-xs font-bold text-primary hover:text-blue-700">Xem tất cả cảnh báo</button>
                                </div>
                            </div>
 
                        </div>
                    </div>
                </div>
            </div>
        </main>
<script src="~/js/chart.js"></script>
